## 内存分配

编程语言的内存分配器一般的分配方法：
- 线性分配器（sequential allocator, bump allocator）
- 空闲链表分配器（free-list allocator）


Go 的内存分配器是基于线程缓存分配器（thread-caching malloc, TCMalloc）设计发散而来

### 分级分配


Go 的内存分配器是借鉴 TCMalloc 的设计实现高速的内存分配，其核心思想是使用多级缓存，将对象根据大小分类，并按照类别实施不同的分配策略


#### 虚拟内存布局

> Go 1.10 以前， 堆区的内存空间都是连续的；1.11 版本开始，使用稀疏的堆内存空间代替连续的内存

**线性内存**

线性内存在 C 和 Go 混合使用时会导致程序崩溃：
- 分配的内存地址会发生冲突，导致堆的初始化和扩容失败
- 没有被预留的大块内存可能会被分配给 C 语言的二进制，导致扩容后的堆不连续


**稀疏内存**