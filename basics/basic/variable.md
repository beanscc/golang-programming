## 变量（variables）



变量是保存值的存储位置。变量允许值的集合取决于变量的类型



一般变量命名

- 驼峰式，比如 QuoteRuneToASCII 或 parseRequestLine 这种，而非 quote_rune_to_ASCII 和 parse_request_line 这种

- 像ASCII和HTML这样的缩略词则避免使用大小写混合的写法，可以使用htmlEscape、HTMLEscape或escapeHTML，但不要使用escapeHtml这种

    

### 变量声明和初始化



变量声明方式：

- 通过 var 声明语句声明（可用于包级或者函数级别变量声明）
- 通过短变量声明（*仅在函数和方法内可用*）



#### 通过 var 声明语句

var 声明语句声明时，值类型可以忽略（此时，值类型时值的默认类型）

```go
// 方式1：var 变量名 类型 = 表达式
var s1 string = "s1"

// 方式2：var 变量名 = 表达式
var s2 = "s2" // 方式2 声明变量时，未指定变量的类型，这时变量 s2 的类型根据表达式的值来推导变量的类型

// 方式3：var 变量名 类型
var s3 string // 方式3 声明变量时，未指定变量的初始值，这时变量 s3 将被初始化为该变量类型的零值

// 方式4：一次声明多个同类型变量
var n1, n2, n3 int

// 方式5：一次初始化多个不同类型的变量
var b, f, s = true, 2.301, "s"

// 方式6：通过函数返回值方式声明
var fh, err = os.Open(name) // os.Open returns a file and an error
```



#### 短变量声明语句

短变量声明语句一般用于**声明和初始化** *局部变量*，变量的类型通过表达式来自动推导

需要注意：

- 短变量声明，变量值需要显式地给出，变量类型，默认是由值在推导出来的，但也可以使用类型转换显式地指出
- 当使用短变量声明时，至少有一个新的变量，否则无法编译通过



```
// 短变量声明方式： 变量名 := 表达式
s1 := "s1"  // 变量的类型通过表达式来自动推导

// 短变量声明一组多个同类型变量，默认是 int
n1, n2 := 1, 2

// 短变量声明一组不同类型变了，分别是 int, int8
n3, n4 := 3, int8(4)

// 短变量声明一组多个不同类型变量
b, f, s := true, 2.3, "s"

// 交换 i 和 j 的值
i, j = j, i

// 通过函数返回值方式声明
fh, err := os.Open(name)
```

`:=` 是一个变量声明语句，必须至少声明一个新的变量，如下这样是无法编译通过的

```go
fh, err := os.Open(name)
// ...
fh, err := os.Open(name2) // // compile error: no new variables
```



- 使用 new 函数创建指针变量

`new(T)` 创建一个类型为 T 的匿名变量，初始化为 T 类型的零值，然后返回变量地址，返回的类型是 `*T`

```go
p := new(int)
fmt.Println(*p) // output: 0

*p = 6
fmt.Println(*p) // output: 6
```

一般初始化结构体，直接使用字面量语法创建会比使用 new 函数更灵活一些

> new 只是一个预定义标识符，而非关键字，在"命名"一节中预定义标识符部分已经有给出



**类型零值**

变量被声明，但未显式初始化值的，将被赋予变量类型的零值



> 类型零值不等于空值



常见类型零值：

- 数值类型：0
- bool 类型：false
- string 类型：""





### 变量的生命周期

变量生命周期指在程序运行期间变量有效存在的时间间隔

- 对包级别变量来讲，它的生命周期就是整个程序运行周期
- 对局部变量来讲，它的生命周期则是动态的：每当声明语句被执行时，将创建一个新的变量实例，直到这个变量实例不可被访问时，
    该变量实例的存储空间可能就被回收了

### 变量传递方式

在 Go 中，所有变量都以值方式传递，指针变量也被看作以值的方式传递，因为指针变量的值是所指向的内存地址，在函数间传递指针变量，是在传递这个地址值

